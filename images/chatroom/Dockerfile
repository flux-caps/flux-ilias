ARG NODEJS_VERSION
FROM node:$NODEJS_VERSION-alpine

ENV ILIAS_COMMON_CLIENT_ID default
ENV ILIAS_FILESYSTEM_DATA_DIR /var/iliasdata
ENV ILIAS_WEB_DIR /var/www/html

ENV ILIAS_CHATROOM_CLIENT_CONFIG_FILE $ILIAS_FILESYSTEM_DATA_DIR/$ILIAS_COMMON_CLIENT_ID/chatroom/client.cfg
ENV ILIAS_CHATROOM_SERVER_CONFIG_FILE $ILIAS_FILESYSTEM_DATA_DIR/$ILIAS_COMMON_CLIENT_ID/chatroom/server.cfg
ENV ILIAS_CHATROOM_LOG_DIR /var/log/chatroom

ENV ILIAS_CHATROOM_PORT 8080

VOLUME $ILIAS_CHATROOM_LOG_DIR
VOLUME $ILIAS_FILESYSTEM_DATA_DIR
VOLUME $ILIAS_WEB_DIR

EXPOSE $ILIAS_CHATROOM_PORT

COPY ./entrypoint.sh /entrypoint.sh
RUN chmod +x /entrypoint.sh
ENTRYPOINT ["/entrypoint.sh"]
