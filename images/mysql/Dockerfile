ARG MYSQL_VERSION
FROM mysql:$MYSQL_VERSION

ENV ILIAS_MYSQL_BIND_ADDRESS 0.0.0.0
ENV ILIAS_MYSQL_PORT 3306
ENV ILIAS_MYSQL_CHARACTER_SET_SERVER utf8
ENV ILIAS_MYSQL_COLLATION_SERVER utf8_general_ci
ENV ILIAS_MYSQL_MAX_ALLOWED_PACKET 67108864
ENV ILIAS_MYSQL_DEFAULT_AUTHENTICATION_PLUGIN mysql_native_password
ENV ILIAS_MYSQL_LOG_DIR /var/log/mysql
ENV ILIAS_MYSQL_ERROR_LOG $ILIAS_MYSQL_LOG_DIR/error.log
ENV MYSQL_DATABASE ilias
ENV MYSQL_USER ilias

VOLUME $ILIAS_MYSQL_LOG_DIR

EXPOSE $ILIAS_MYSQL_PORT

COPY ./entrypoint.sh /entrypoint-custom.sh
RUN chmod +x /entrypoint-custom.sh
ENTRYPOINT ["/entrypoint-custom.sh"]
